const P=Math.min,U=Math.max,O=Math.round,x=Math.floor,F=t=>({x:t,y:t});function j(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function C(){return typeof window<"u"}function W(t){return H(t)?(t.nodeName||"").toLowerCase():"#document"}function g(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _(t){var e;return(e=(H(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function H(t){return C()?t instanceof Node||t instanceof g(t).Node:!1}function k(t){return C()?t instanceof Element||t instanceof g(t).Element:!1}function L(t){return C()?t instanceof HTMLElement||t instanceof g(t).HTMLElement:!1}function A(t){return!C()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof g(t).ShadowRoot}const K=new Set(["inline","contents"]);function I(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=T(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!K.has(o)}function X(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Y=new Set(["html","body","#document"]);function G(t){return Y.has(W(t))}function T(t){return g(t).getComputedStyle(t)}function J(t){if(W(t)==="html")return t;const e=t.assignedSlot||t.parentNode||A(t)&&t.host||_(t);return A(e)?e.host:e}function $(t){const e=J(t);return G(e)?t.ownerDocument?t.ownerDocument.body:t.body:L(e)&&I(e)?e:$(e)}function S(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=$(t),c=o===((r=t.ownerDocument)==null?void 0:r.body),i=g(o);if(c){const s=N(i);return e.concat(i,i.visualViewport||[],I(o)?o:[],s&&n?S(s):[])}return e.concat(o,S(o,[],n))}function N(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Q(t){const e=T(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=L(t),c=o?t.offsetWidth:n,i=o?t.offsetHeight:r,s=O(n)!==c||O(r)!==i;return s&&(n=c,r=i),{width:n,height:r,$:s}}function D(t){return k(t)?t:t.contextElement}function B(t){const e=D(t);if(!L(e))return F(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:c}=Q(e);let i=(c?O(n.width):n.width)/r,s=(c?O(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const Z=F(0);function tt(t){const e=g(t);return!X()||!e.visualViewport?Z:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function et(t,e,n){return!1}function V(t,e,n,r){e===void 0&&(e=!1);const o=t.getBoundingClientRect(),c=D(t);let i=F(1);e&&(i=B(t));const s=et()?tt(c):F(0);let a=(o.left+s.x)/i.x,l=(o.top+s.y)/i.y,v=o.width/i.x,p=o.height/i.y;if(c){const y=g(c),d=r;let m=y,u=N(m);for(;u&&r&&d!==m;){const h=B(u),f=u.getBoundingClientRect(),w=T(u),b=f.left+(u.clientLeft+parseFloat(w.paddingLeft))*h.x,E=f.top+(u.clientTop+parseFloat(w.paddingTop))*h.y;a*=h.x,l*=h.y,v*=h.x,p*=h.y,a+=b,l+=E,m=g(u),u=N(m)}}return j({width:v,height:p,x:a,y:l})}function q(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function nt(t,e){let n=null,r;const o=_(t);function c(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const l=t.getBoundingClientRect(),{left:v,top:p,width:y,height:d}=l;if(s||e(),!y||!d)return;const m=x(p),u=x(o.clientWidth-(v+y)),h=x(o.clientHeight-(p+d)),f=x(v),b={rootMargin:-m+"px "+-u+"px "+-h+"px "+-f+"px",threshold:U(0,P(1,a))||1};let E=!0;function M(z){const R=z[0].intersectionRatio;if(R!==a){if(!E)return i();R?i(!1,R):r=setTimeout(()=>{i(!1,1e-7)},1e3)}R===1&&!q(l,t.getBoundingClientRect())&&i(),E=!1}try{n=new IntersectionObserver(M,{...b,root:o.ownerDocument})}catch{n=new IntersectionObserver(M,b)}n.observe(t)}return i(!0),c}function ot(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,l=D(t),v=o||c?[...l?S(l):[],...S(e)]:[];v.forEach(f=>{o&&f.addEventListener("scroll",n,{passive:!0}),c&&f.addEventListener("resize",n)});const p=l&&s?nt(l,n):null;let y=-1,d=null;i&&(d=new ResizeObserver(f=>{let[w]=f;w&&w.target===l&&d&&(d.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(e)})),n()}),l&&!a&&d.observe(l),d.observe(e));let m,u=a?V(t):null;a&&h();function h(){const f=V(t);u&&!q(u,f)&&n(),u=f,m=requestAnimationFrame(h)}return n(),()=>{var f;v.forEach(w=>{o&&w.removeEventListener("scroll",n),c&&w.removeEventListener("resize",n)}),p?.(),(f=d)==null||f.disconnect(),d=null,a&&cancelAnimationFrame(m)}}export{ot as a};
